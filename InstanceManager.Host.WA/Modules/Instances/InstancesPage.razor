@page "/instances"
@using InstanceManager.Application.Contracts.ProjectInstance

<FluentStack Orientation="Orientation.Horizontal" VerticalAlignment="VerticalAlignment.Center">
    <h3 style="margin: 0;">Project Instances</h3>
    
    <FluentNavLink Href="@NavHelper.BuildUrl("action", "create")">
        <FluentButton Appearance="Appearance.Accent" IconStart="@(new Icons.Regular.Size20.Add())" />
    </FluentNavLink>
</FluentStack>

<FluentDivider Style="margin: 16px 0;" />

<FluentStack Orientation="Orientation.Horizontal" VerticalGap="8">
    <FluentButton Appearance="@(_renderMode == RenderMode.FluentTree ? Appearance.Accent : Appearance.Neutral)"
                  OnClick="@(() => _renderMode = RenderMode.FluentTree)">
        Fluent - Tree
    </FluentButton>
    <FluentButton Appearance="@(_renderMode == RenderMode.WebAwesomeTree ? Appearance.Accent : Appearance.Neutral)"
                  OnClick="@(() => _renderMode = RenderMode.WebAwesomeTree)">
        WebAwesome - Tree
    </FluentButton>
</FluentStack>

<FluentDivider Style="margin: 16px 0;" />

<DataLoader TResponse="List<ProjectInstanceDto>"
            TQuery="GetAllProjectInstancesQuery"
            Query="new GetAllProjectInstancesQuery()"
            CacheKey="all_project_instances"
            RefreshToken="@_refreshToken"
            OnDataFetched="HandleDataFetched">
    <ChildContent Context="instances">
        <div style="display: @(_renderMode == RenderMode.FluentTree ? "block" : "none")">
            <FluentTreeView Items="Items" SelectedItemChanged="SelectedItemChanged" SelectedItem="SelectedItem" />
        </div>
        
        <div style="display: @(_renderMode == RenderMode.WebAwesomeTree ? "block" : "none")">
            <InstancesWebAwesomeTree AllInstances="AllInstances" 
                                     SelectedInstanceId="GetSelectedInstanceId()" 
                                     OnInstanceSelected="HandleWebAwesomeItemSelected" />
        </div>
    </ChildContent>
</DataLoader>

